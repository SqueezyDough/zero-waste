

<h1>Zero Waste</h1>

<svg width="900" height="800" id="map"></svg>


<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v1.min.js"></script>
<script src="https://d3js.org/topojson.v2.min.js"></script>

<script>
const svg = d3.select('#map');
const width = +svg.attr('width');
const height = +svg.attr('height');

const projection = d3.geoAlbers()
  .center([4.9, 52.366667])
  .parallels([51.5, 51.49])
  .rotate(120)
  .scale(250000)
  .translate([width / 2, height / 2]);

const path = d3.geoPath()
  .projection(projection);

const district = { A: 'Centrum', B: 'Westpoort', E: 'West', M: 'Oost', K: 'Zuid', F: 'Nieuw west', N: 'Noord', T: 'Zuidoost' };

colorDistricts = d3.scaleThreshold()
  .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
  .range(d3.schemeBlues[7]);

d3.queue()
  .defer(d3.json, './static/data/src/districts.json')
  .await(ready);

function ready (error, neighborhood) {
  if (error) throw error;

  /* Areas */
  const districts = topojson.feature(neighborhood, neighborhood.objects.buurten).features;

  // Draw the buurten
  svg.selectAll('.neighborhood')
    .data(districts)
    .enter().insert('g')
    .append('path')
    .attr('class', 'neighborhood')
    .attr('d', path)
    .attr('fill', function (d) { return colorDistricts(d.properties.Stadsdeel_code[0]); })
    .append('title')
    .text(function (d) { return district[d.properties.Stadsdeel_code] + ': ' + d.properties.Buurtcombinatie; });

  // Draw borders around buurten
  svg.append('path')
    .attr('class', 'neighborhood-borders')
    .attr('d', path(topojson.mesh(neighborhood, neighborhood.objects.buurten, function (a, b) { return a !== b; })));

  // Draw borders around districts
  svg.append('path')
    .attr('class', 'neighborhood-borders')
    .attr('d', path(topojson.mesh(neighborhood, neighborhood.objects.buurten, function (a, b) { return district[a.properties.Stadsdeel_code] !== stadsdeel[b.properties.Stadsdeel_code]; })));
};

</script>